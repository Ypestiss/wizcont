<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring4-4.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>WizCont.</title>
    <link th:href="@{styles/css/appStyles.css}" rel="stylesheet" type="text/css" />
    <script th:src="@{styles/instascan.min.js}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5-qrcode/2.3.4/html5-qrcode.min.js" integrity="sha512-k/KAe4Yff9EUdYI5/IAHlwUswqeipP+Cp5qnrsUjTPCgl51La2/JhyyjNciztD7mWNKLSXci48m7cctATKfLlQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js" integrity="sha512-CNgIRecGo7nphbeZ04Sc13ka07paqdeTu0WR1IM4kNcpmBAUSHSQX0FslNhTDadL4O5SAGapGt4FodqL8My0mA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  </head>
  <body id="light-theme">
    <!-- Barra de Navegação -->
    <div class="container">
      <div class="navigation">
        <ul>
          <!-----------------------------Indicador do estoque------------------------------>
          <li class="list active">
            <a href="#estoque" onclick="mostrarEstoque()">
              <span class="icon">
                <img src="./icons/StockWhite.svg" id="stockIcon" width="25px" height="25px">
              </span>
              <span class="text">Estoque</span>
            </a>
          </li>
          <!-----------------------------Indicador do cardápio------------------------------>
          <li class="list active">
            <a href="#qrcode" onclick="mostrarCardapio()">
              <span class="icon"><img src="icons/MetaIcon.svg" id="metaIcon" width="25px" height="25px"></span>
              <span class="text">Cardápio</span>
            </a>
          </li>
          <li class="list active">
            <a href="#qrcode2" onclick="mostrarNotificacao()">
              <span class="icon"><img src="icons/BellIcon.svg" id="metaIcon" width="25px" height="25px"></span>              <span class="text">Notificações</span>
            </a>
          </li>
          <!-----------------------------Indicador do perfil------------------------------>
          <li class="list active">
            <a href="#perfil" onclick="mostrarPerfil()">
              <span class="icon"><img src="icons/icon.svg" id="metaIcon" width="25px" height="25px"></span>
              <span class="text">Perfil</span>
            </a>
          </li>
          <li class="list active">
            <a href="#config" onclick="mostrarConfiguracao()">           
              <span class="icon"><img src="icons/ConfigIcon.svg" id="metaIcon" width="25px" height="25px"></span>
              <span class="text">Configurações</span>
            </a>
          </li>
          <div class="indicator"></div>
        </ul>  
      </div>
    </div>

    <!-- Conteúdos -->

    <div id="conteudo">
      <!-- Conteúdo da página de Estoque -->
        <!------- Alimentos ------->
        <div id="estoque" style="display: none;">
          
          <h2 id="titleestoque">Alimentos</h2>
          <div class="category">
            <h2 class="subtitleestoque">Proteína animal</h2>
            <div class="card-container" id='Carnes-list'>
              <div class="card"  id="cards" th:each="item : ${itensBanco}" th:if="${item.categoria == T(com.webapp.Wizcont.model.enums.StatusCategoria).Carnes}" th:attr="data-idItem=${item.id_Item}, data-nome=${item.nome_item}, data-qtdItem=${item.qtd_item}, data-medidaItem=${item.medida}, data-categoria=${item.categoria}">
                  <td th:text="${item.nome_item}"></td>
                  <input th:id="'qtdItemInput-' + ${item.id_Item}" type="number" th:placeholder="${item.qtd_item}" th:value="${item.qtd_item}" style="width: 80px; background-color: #f2f2f2;">
                  <select th:name="'medidaItem_' + ${itemStat.index}">
                    <option th:each="medida : ${T(com.webapp.Wizcont.model.enums.StatusMedida).values()}" th:value="${medida}" th:text="${medida.name()}"></option>
                    <option th:selected="${item.medida == medida}" th:value="${item.medida}" th:text="${item.medida.name()}"></option>
                </select>
                  <button th:onclick="showit([[${item.categoria}]])" style="background-color: transparent; color: red;" th:text="Excluir"  class="btn-excluir"></button>
                  <script>
                    document.getElementById('qtdItemInput-[[${item.id_Item}]]').addEventListener('input', function() {
                        var newValue = this.value;
                        this.setAttribute('newData-qtdItem', newValue);
                    });
                </script>
              </div>
            </div>  
            <button onclick="adicionarItem('Carnes')">+</button>
          </div>

          <div class="category">
            <h2 class="subtitleestoque">Frutas</h2>
            <div class="card-container" id="Frutas-list">
              <div class="card" id="cards" th:each="item : ${itensBanco}" th:if="${item.categoria == T(com.webapp.Wizcont.model.enums.StatusCategoria).Frutas}">
                <!-- <th:block th:if="${item.categoria == T(com.webapp.Wizcont.model.enums.StatusCategoria).Frutas}"> -->
                  <td id="Item" th:text="${item.nome_item}"></td>
                  <input id="qtdItemInput" type="number" th:placeholder="${item.qtd_item}" th:value="${item.qtd_item}" style="width: 80px; background-color: #f2f2f2;">
                  <script>
                    document.getElementById('qtdItemInput').addEventListener('input', function() {
                        var newValue = this.value;
                        document.querySelector('[newData-qtdItem]').setAttribute('newData-qtdItem', newValue);
                    });
                  </script>
                  <select  :name="'medidaItem_' + ${itemStat.index}">
                    <option th:each="medida : ${T(com.webapp.Wizcont.model.enums.StatusMedida).values()}" th:value="${medida}" th:text="${medida.name()}"></option>
                    <option th:selected="${item.medida == medida}" th:value="${item.medida}" th:text="${item.medida.name()}"></option>
                </select>
                  <button style="background-color: transparent; color: red;" th:text="Excluir" th:attr="data-nome-excluir=${item.nome_item}" class="btn-excluir"></button>
                <!-- </th:block> -->
              </div>
            </div>
            <button onclick="adicionarItem('Frutas')">+</button>
          </div>

          <div class="category">
            <h2 class="subtitleestoque">Grãos</h2>
            <div class="card-container" id="Grãos-list"></div>
            <div class="card" id="cards" th:each="item : ${itensBanco}" th:if="${item.categoria == T(com.webapp.Wizcont.model.enums.StatusCategoria).Grãos}">
                <td id="Item" th:text="${item.nome_item}"></td>
                <input type="number" th:placeholder="${item.qtd_item}" th:value="${item.qtd_item}" style="width: 80px; background-color: #f2f2f2;">
                <select th:name="'medidaItem_' + ${itemStat.index}">
                  <option th:each="medida : ${T(com.webapp.Wizcont.model.enums.StatusMedida).values()}" th:value="${medida}" th:text="${medida.name()}"></option>
                  <option th:selected="${item.medida == medida}" th:value="${item.medida}" th:text="${item.medida.name()}"></option>
              </select>
                <button style="background-color: transparent; color: red;" th:text="Excluir" th:attr="data-nome-excluir=${item.nome_item}" class="btn-excluir"></button>
            </div>
            <button onclick="adicionarItem('Grãos')">+</button>
          </div>

          <div class="category">
            <h2 class="subtitleestoque">Legumes</h2>
            <div class="card-container" id="Legumes-list"></div>
            <div class="card" id="cards" th:each="item : ${itensBanco}" th:if="${item.categoria == T(com.webapp.Wizcont.model.enums.StatusCategoria).Legumes}">
                <td id="Item" th:text="${item.nome_item}"></td>
                <input type="number" th:placeholder="${item.qtd_item}" th:value="${item.qtd_item}" style="width: 80px; background-color: #f2f2f2;">
                <select th:name="'medidaItem_' + ${itemStat.index}">
                  <option th:each="medida : ${T(com.webapp.Wizcont.model.enums.StatusMedida).values()}" th:value="${medida}" th:text="${medida.name()}"></option>
                  <option th:selected="${item.medida == medida}" th:value="${item.medida}" th:text="${item.medida.name()}"></option>
              </select>
                <button style="background-color: transparent; color: red;" th:text="Excluir" th:attr="data-nome-excluir=${item.nome_item}" class="btn-excluir"></button>
            </div>
            <button onclick="adicionarItem('Legumes')">+</button>
          </div>

          <div class="category">
            <h2 class="subtitleestoque">Vegetais</h2>
            <div class="card-container" id="Vegetais-list"></div>
            <div class="card" id="cards"th:each="item : ${itensBanco}" th:if="${item.categoria == T(com.webapp.Wizcont.model.enums.StatusCategoria).Vegetais}">
                <td id="Item" th:text="${item.nome_item}"></td>
                <input type="number" th:placeholder="${item.qtd_item}" th:value="${item.qtd_item}" style="width: 80px; background-color: #f2f2f2;">
                <select th:name="'medidaItem_' + ${itemStat.index}">
                  <option th:each="medida : ${T(com.webapp.Wizcont.model.enums.StatusMedida).values()}" th:value="${medida}" th:text="${medida.name()}"></option>
                  <option th:selected="${item.medida == medida}" th:value="${item.medida}" th:text="${item.medida.name()}"></option>
                </select>
                <button style="background-color: transparent; color: red;" th:text="Excluir" th:attr="data-nome-excluir=${item.nome_item}" class="btn-excluir"></button>
            </div>
            <button onclick="adicionarItem('Vegetais')">+</button>
          </div>

          <div class="category">
            <h2 class="subtitleestoque">Verduras</h2>
            <div class="card-container" id="Verduras-list"></div>
            <div class="card" th:each="item : ${itensBanco}" th:if="${item.categoria == T(com.webapp.Wizcont.model.enums.StatusCategoria).Verduras}">
                <td th:text="${item.nome_item}"></td>
                <input type="number" th:placeholder="${item.qtd_item}" th:value="${item.qtd_item}" style="width: 80px; background-color: #f2f2f2;">
                <select th:name="'medidaItem_' + ${itemStat.index}">
                  <option th:each="medida : ${T(com.webapp.Wizcont.model.enums.StatusMedida).values()}" th:value="${medida}" th:text="${medida.name()}"></option>
                  <option th:selected="${item.medida == medida}" th:value="${item.medida}" th:text="${item.medida.name()}"></option>
              </select>
                <button style="background-color: transparent; color: red;" th:text="Excluir" th:attr="data-nome-excluir=${item.nome_item}" class="btn-excluir"></button>
            </div>
            <button onclick="adicionarItem('Verduras')">+</button>
          </div>

          <div class="container">
            <button th:onclick="trocarSecao()">Trocar Seção</button>
            <button onclick="saveItens()">Salvar</button>
          </div>
          
        </div>

        <!------- Limpeza ------->

        <div id="estoque-limp" style="display: none;">
          <h2 id="titleLimp">Limpeza</h2>
        
          <div class="category-limp">
            <h2 class="subtitleLimp">Piso</h2>
            <div class="card-container" id="piso-list"></div>
            <button onclick="adicionarItemLimp('piso')">+</button>
          </div>
          
          <div class="category-limp">
            <h2 class="subtitleLimp">Superfície de vidro</h2>
            <div class="card-container" id="vidro-list"></div>
            <button onclick="adicionarItemLimp('vidro')">+</button>
          </div>

          <div class="category-limp">
            <h2 class="subtitleLimp">Superfície de metálica</h2>
            <div class="card-container" id="metal-list"></div>
            <button onclick="adicionarItemLimp('metal')">+</button>
          </div>

        <div class="container">
          <button onclick="trocarSecao()">Trocar Seção</button>
          <button onclick="saveItens()">Salvar</button>
        </div>

        </div>

        <!-- Conteúdo da página do leitor de QR -->
        <div id="qr-container" style="display: none;">                   
          <div class="menu-container">
            <h1>Leitor QR-CODE</h1>
            <style>
              #cam-menu {
                  display: flex;
                  justify-content: center;
                  align-items: center;
              }
              #reader {
                  width: 600px;
              }
              #result {
                  text-align: center;
                  font-size: 1.5rem;
              }
            </style>
            <button id="scanQR-button" onclick="scanQR()">Scan</button>        
            <div id ="cam-menu">
              <div id="reader"></div>
              <div id="result"></div>
            </div>
            <button id="complete-scan" display='none'>Salvar</button>
          </div>
        </div>

        <!-- Conteúdo da página de Gerador de QR -->
        <div id="qr-generator" style="display: none;">
          <h2>Gerador QRcode</h2>
          <button id="generateQR-button" onclick="generateQR()">gerar QR</button>
          <div id="generator-result"></div>

        </div>

        <!-- Conteúdo da página de Perfil -->
        <div id="perfil" style="display: none;">
          <div class="profile-info">
            <label for="fileInput" class="profile-picture"> 
              <input type="file" id="fileInput" accept="image/*" onchange="previewImage(event)">
              <img id="preview" src="icons/icon.png" alt="Foto de Perfil" onclick="alterarImagem()">
            </label>
            <div class="user-details">
              <tr th:each="user: ${usuario}">
                <p id='perfil-nome'  name='perfil-nome'>Usuario:><td th:text="${user.getNome_usuario()}" /></p>
                <p id='perfil-email' name='perfil-email'>Email:><td th:text="${user.getEmail()}" /></p>
              </tr>
            </div>
          </div>
              <div id="opcoesPerfil">
                <p id="assinatura"><a href="#">Assinatura</a></p>
                
                <div id="trocarDados">
                  <button id='emailButton' onclick="changeEmail()">Alterar email</button>
                </div>
              </div>
              <form th:action="@{/logoff}">
                <button type='submit'>Desconectar</button>
              </form>

        </div>

        <!-- Conteúdo da página de Configuração -->
        <div id="configuracao" class="config-content" style="display: none;">
          <h2>Configuração</h2>

          <input type="checkbox" id="darklight" class="darklight">

          <div class="setting-item"> 
            <a id="sair" th:href="@{/logoff}">Sair</a>
        </div>
        <!-- Adicione outras seções conforme necessário -->
    </div>


  </body>
  <script th:src="@{styles/js/app/appTools.js}"></script>
  <script th:src="@{styles/js/app/appTheme.js}"></script>
  <script th:src="@{styles/js/app/appConfig.js}"></script>
  <script th:src="@{styles/js/app/appUser.js}"></script>
  <script th:src="@{styles/js/app/navBar.js}"></script>
  <script th:src="@{styles/js/app/estoque/formatação.js}"></script>
</html>